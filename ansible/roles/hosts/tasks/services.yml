---
# file: tasks/services.yml

- name: services - enable/disable hosts services
  when: ansible_service_mgr|lower != "openrc" and ansible_service_mgr|lower != "runit"
  with_items: "{{ hosts_services|default([]) }}"
  service:
    name: "{{item.name}}"
    state: "{{item.state}}"
    enabled: "{{item.enabled}}"
  become: yes

- name: services - enable/disable hosts services - openrc
  when: ansible_service_mgr|lower == "openrc"
  with_items: "{{ hosts_services|default([]) }}"
  service:
    name: "{{item.name}}"
    state: "{{item.state}}"
    enabled: "{{item.enabled}}"
    runlevel: boot
  become: yes

- name: services - enable/disable hosts services - runit
  when: ansible_service_mgr|lower == "runit"
  with_items: "{{ hosts_services|default([]) }}"
  sysvinit:
    name: "{{item.name}}"
    state: "{{item.state}}"
    enabled: "{{item.enabled}}"
    runlevels:
      - 2
      - 3
      - 4
      - 5
  become: yes

